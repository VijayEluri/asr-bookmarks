
    

  

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>assaf/necktie - GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub" />
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub" />

    <link href="https://assets0.github.com/stylesheets/bundle_common.css?52a04f4d5bac1e6525ba43735c8142489bd7a665" media="screen" rel="stylesheet" type="text/css" />
<link href="https://assets3.github.com/stylesheets/bundle_github.css?52a04f4d5bac1e6525ba43735c8142489bd7a665" media="screen" rel="stylesheet" type="text/css" />

    <script type="text/javascript" charset="utf-8">
      var GitHub = {}
      var github_user = null
      
    </script>
    <script src="https://assets1.github.com/javascripts/jquery/jquery-1.4.2.min.js?52a04f4d5bac1e6525ba43735c8142489bd7a665" type="text/javascript"></script>
    <script src="https://assets1.github.com/javascripts/bundle_common.js?52a04f4d5bac1e6525ba43735c8142489bd7a665" type="text/javascript"></script>
<script src="https://assets2.github.com/javascripts/bundle_github.js?52a04f4d5bac1e6525ba43735c8142489bd7a665" type="text/javascript"></script>


        <script type="text/javascript" charset="utf-8">
      GitHub.spy({
        repo: "assaf/necktie"
      })
    </script>

    
  
    
  

  <link href="https://github.com/assaf/necktie/commits/master.atom" rel="alternate" title="Recent Commits to necktie:master" type="application/atom+xml" />

        <meta name="description" content="Dress to impress / Our minimalistic server configuration tool" />
    <script type="text/javascript">
      GitHub.nameWithOwner = GitHub.nameWithOwner || "assaf/necktie";
      GitHub.currentRef = 'master';
      GitHub.commitSHA = "0bfe0e687fc13d916e68060b99c9aa13e7252309";
      GitHub.currentPath = "";
      GitHub.masterBranch = "master";

      
        GitHub.currentTreeSHA = "0bfe0e687fc13d916e68060b99c9aa13e7252309";
      
    </script>
  

            <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-3769691-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script');
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        ga.setAttribute('async', 'true');
        document.documentElement.firstChild.appendChild(ga);
      })();
    </script>

  </head>

  

  <body class="logged_out ">
    

    
      <script type="text/javascript">
        var _kmq = _kmq || [];
        function _kms(u){
          var s = document.createElement('script'); var f = document.getElementsByTagName('script')[0]; s.type = 'text/javascript'; s.async = true;
          s.src = u; f.parentNode.insertBefore(s, f);
        }
        _kms('//i.kissmetrics.com/i.js');_kms('//doug1izaerwt3.cloudfront.net/406e8bf3a2b8846ead55afb3cfaf6664523e3a54.1.js');
      </script>
    

    

    

    

    <div class="subnavd" id="main">
      <div id="header" class="true">
        
          <a class="logo boring" href="https://github.com">
            <img src="/images/modules/header/logov3.png?changed" class="default" alt="github" />
            <![if !IE]>
            <img src="/images/modules/header/logov3-hover.png" class="hover" alt="github" />
            <![endif]>
          </a>
        
        
        <div class="topsearch">
  
    <ul class="nav logged_out">
      <li class="pricing"><a href="/plans">Pricing and Signup</a></li>
      <li><a href="/explore">Explore GitHub</a></li>
      <li><a href="/features">Features</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="https://github.com/login">Login</a></li>
    </ul>
  
</div>

      </div>

      
      
        
    <div class="site">
      <div class="pagehead repohead vis-public   ">

      

      <div class="title-actions-bar">
        <h1>
          <a href="/assaf">assaf</a> / <strong><a href="https://github.com/assaf/necktie">necktie</a></strong>
          
          
        </h1>

        
    <ul class="actions">
      

      
        <li class="for-owner" style="display:none"><a href="https://github.com/assaf/necktie/admin" class="minibutton btn-admin "><span><span class="icon"></span>Admin</span></a></li>
        <li>
          <a href="/assaf/necktie/toggle_watch" class="minibutton btn-watch " id="watch_button" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'd0410eef863baff064a950b7329753a7c5bc1cac'); f.appendChild(s);f.submit();return false;" style="display:none"><span><span class="icon"></span>Watch</span></a>
          <a href="/assaf/necktie/toggle_watch" class="minibutton btn-watch " id="unwatch_button" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'd0410eef863baff064a950b7329753a7c5bc1cac'); f.appendChild(s);f.submit();return false;" style="display:none"><span><span class="icon"></span>Unwatch</span></a>
        </li>
        
          
            <li class="for-notforked" style="display:none"><a href="/assaf/necktie/fork" class="minibutton btn-fork " id="fork_button" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'd0410eef863baff064a950b7329753a7c5bc1cac'); f.appendChild(s);f.submit();return false;"><span><span class="icon"></span>Fork</span></a></li>
            <li class="for-hasfork" style="display:none"><a href="#" class="minibutton btn-fork " id="your_fork_button"><span><span class="icon"></span>Your Fork</span></a></li>
          

          
        
      
      
      <li class="repostats">
        <ul class="repo-stats">
          <li class="watchers"><a href="/assaf/necktie/watchers" title="Watchers" class="tooltipped downwards">33</a></li>
          <li class="forks"><a href="/assaf/necktie/network" title="Forks" class="tooltipped downwards">2</a></li>
        </ul>
      </li>
    </ul>

      </div>

        
  <ul class="tabs">
    <li><a href="https://github.com/assaf/necktie" class="selected" highlight="repo_source">Source</a></li>
    <li><a href="https://github.com/assaf/necktie/commits/master" highlight="repo_commits">Commits</a></li>
    <li><a href="/assaf/necktie/network" highlight="repo_network">Network</a></li>
    <li><a href="/assaf/necktie/pulls" highlight="repo_pulls">Pull Requests (0)</a></li>

    

    
      
      <li><a href="/assaf/necktie/issues" highlight="issues">Issues (0)</a></li>
    

            
    <li><a href="/assaf/necktie/graphs" highlight="repo_graphs">Graphs</a></li>

    <li class="contextswitch nochoices">
      <span class="toggle leftwards" >
        <em>Branch:</em>
        <code>master</code>
      </span>
    </li>
  </ul>

  <div style="display:none" id="pl-description"><p><em class="placeholder">click here to add a description</em></p></div>
  <div style="display:none" id="pl-homepage"><p><em class="placeholder">click here to add a homepage</em></p></div>

  <div class="subnav-bar">
  
  <ul>
    <li>
      <a href="#" class="dropdown">Switch Branches (1)</a>
      <ul>
        
          
            <li><strong>master &#x2713;</strong></li>
            
      </ul>
    </li>
    <li>
      <a href="#" class="dropdown ">Switch Tags (8)</a>
              <ul>
                      
              <li><a href="/assaf/necktie/tree/v1.1.0">v1.1.0</a></li>
            
                      
              <li><a href="/assaf/necktie/tree/1.0.6">1.0.6</a></li>
            
                      
              <li><a href="/assaf/necktie/tree/1.0.5">1.0.5</a></li>
            
                      
              <li><a href="/assaf/necktie/tree/1.0.4">1.0.4</a></li>
            
                      
              <li><a href="/assaf/necktie/tree/1.0.3">1.0.3</a></li>
            
                      
              <li><a href="/assaf/necktie/tree/1.0.2">1.0.2</a></li>
            
                      
              <li><a href="/assaf/necktie/tree/1.0.1">1.0.1</a></li>
            
                      
              <li><a href="/assaf/necktie/tree/1.0.0">1.0.0</a></li>
            
                  </ul>
      
    </li>
    <li>
    
    <a href="/assaf/necktie/branches" class="manage">Branch List</a>
    
    </li>
  </ul>
</div>

  
  
  
  
  
  



        
    <div id="repo_details" class="metabox clearfix">
      <div id="repo_details_loader" class="metabox-loader" style="display:none">Sending Request&hellip;</div>

        <a href="/assaf/necktie/downloads" class="download-source" id="download_button" title="Download source, tagged packages and binaries."><span class="icon"></span>Downloads</a>

      <div id="repository_desc_wrapper">
      <div id="repository_description" rel="repository_description_edit">
        
          <p>Dress to impress / Our minimalistic server configuration tool
            <span id="read_more" style="display:none">&mdash; <a href="#readme">Read more</a></span>
          </p>
        
      </div>

      <div id="repository_description_edit" style="display:none;" class="inline-edit">
        <form action="/assaf/necktie/admin/update" method="post"><div style="margin:0;padding:0"><input name="authenticity_token" type="hidden" value="d0410eef863baff064a950b7329753a7c5bc1cac" /></div>
          <input type="hidden" name="field" value="repository_description">
          <input type="text" class="textfield" name="value" value="Dress to impress / Our minimalistic server configuration tool">
          <div class="form-actions">
            <button class="minibutton"><span>Save</span></button> &nbsp; <a href="#" class="cancel">Cancel</a>
          </div>
        </form>
      </div>

      
      <div class="repository-homepage" id="repository_homepage" rel="repository_homepage_edit">
        <p><a href="http://blog.labnotes.org/2009/11/04/necktie-dress-to-impress/" rel="nofollow">http://blog.labnotes.org/2009/11/04/necktie-dress-to-impress/</a></p>
      </div>

      <div id="repository_homepage_edit" style="display:none;" class="inline-edit">
        <form action="/assaf/necktie/admin/update" method="post"><div style="margin:0;padding:0"><input name="authenticity_token" type="hidden" value="d0410eef863baff064a950b7329753a7c5bc1cac" /></div>
          <input type="hidden" name="field" value="repository_homepage">
          <input type="text" class="textfield" name="value" value="http://blog.labnotes.org/2009/11/04/necktie-dress-to-impress/">
          <div class="form-actions">
            <button class="minibutton"><span>Save</span></button> &nbsp; <a href="#" class="cancel">Cancel</a>
          </div>
        </form>
      </div>
      </div>
      <div class="rule "></div>
            <div id="url_box" class="url-box">
        <ul class="clone-urls">
          
            
            <li id="http_clone_url"><a href="https://github.com/assaf/necktie.git" data-permissions="Read-Only">HTTP</a></li>
            <li id="public_clone_url"><a href="git://github.com/assaf/necktie.git" data-permissions="Read-Only">Git Read-Only</a></li>
          
          
        </ul>
        <input type="text" spellcheck="false" id="url_field" class="url-field" />
              <span style="display:none" id="url_box_clippy"></span>
      <span id="clippy_tooltip_url_box_clippy" class="clippy-tooltip tooltipped" title="copy to clipboard">
      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
              width="14"
              height="14"
              class="clippy"
              id="clippy" >
      <param name="movie" value="https://assets1.github.com/flash/clippy.swf?v5"/>
      <param name="allowScriptAccess" value="always" />
      <param name="quality" value="high" />
      <param name="scale" value="noscale" />
      <param NAME="FlashVars" value="id=url_box_clippy&amp;copied=&amp;copyto=">
      <param name="bgcolor" value="#FFFFFF">
      <param name="wmode" value="opaque">
      <embed src="https://assets1.github.com/flash/clippy.swf?v5"
             width="14"
             height="14"
             name="clippy"
             quality="high"
             allowScriptAccess="always"
             type="application/x-shockwave-flash"
             pluginspage="http://www.macromedia.com/go/getflashplayer"
             FlashVars="id=url_box_clippy&amp;copied=&amp;copyto="
             bgcolor="#FFFFFF"
             wmode="opaque"
      />
      </object>
      </span>

        <p id="url_description">This URL has <strong>Read+Write</strong> access</p>
      </div>
    </div>


        

      </div><!-- /.pagehead -->

      









<script type="text/javascript">
  GitHub.currentCommitRef = 'master'
  GitHub.currentRepoOwner = 'assaf'
  GitHub.currentRepo = "necktie"
  GitHub.downloadRepo = '/assaf/necktie/archives/master'
  GitHub.revType = "master"

  GitHub.controllerName = "tree"
  GitHub.actionName     = "show"
  GitHub.currentAction  = "tree#show"

  

  
</script>








  <div id="commit">
    <div class="group">
        
  <div class="envelope commit">
    <div class="human">
      
        <div class="message"><pre><a href="/assaf/necktie/commit/0bfe0e687fc13d916e68060b99c9aa13e7252309">Changed: Capistrano can pull from one of these locations ($ denotes variable):</a> </pre></div>
      

      <div class="actor">
        <div class="gravatar">
          
          <img src="https://secure.gravatar.com/avatar/a62b87a36bfc29a7207bc73f3aac960b?s=140&d=https%3A%2F%2Fgithub.com%2Fimages%2Fgravatars%2Fgravatar-140.png" alt="" width="30" height="30"  />
        </div>
        <div class="name"><a href="/assaf">assaf</a> <span>(author)</span></div>
        <div class="date">
          <abbr class="relatize" title="2010-04-12 11:58:27">Mon Apr 12 11:58:27 -0700 2010</abbr>
        </div>
      </div>

      

    </div>
    <div class="machine">
      <span>c</span>ommit&nbsp;&nbsp;<a href="/assaf/necktie/commit/0bfe0e687fc13d916e68060b99c9aa13e7252309" hotkey="c">0bfe0e687fc13d916e68</a><br />
      <span>t</span>ree&nbsp;&nbsp;&nbsp;&nbsp;<a href="/assaf/necktie/tree/0bfe0e687fc13d916e68060b99c9aa13e7252309/lib/necktie/gems.rb" hotkey="t">a3ed545a995cd390ad56</a><br />
      
        <span>p</span>arent&nbsp;
        
        <a href="/assaf/necktie/commit/81728a0b1317b71d58fe96e43844d19400bab3e7" hotkey="p">81728a0b1317b71d58fe</a>
      

    </div>
  </div>

    </div>
  </div>



<div id="slider">
  
    <div class="breadcrumb" data-path="/">
      <b><a href="/assaf/necktie/tree/0bfe0e687fc13d916e68060b99c9aa13e7252309">necktie</a></b> / 
    </div>

    
      


  <div class="frames">
    <div class="frame frame-center" data-path="/">
      <table id="browser" cellpadding="0" cellspacing="0">
        <tr class="header">
          <th></th>
          <th>name</th>
          <th>age</th>
          <th>
            <div class="history">
              <a href="/assaf/necktie/commits/master/">history</a>
            </div>
            message
          </th>
        </tr>

        

        
        
                    <tr class="alt">
            <td class="icon"> <img alt="directory" src="https://assets1.github.com/images/icons/dir.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/tree/0bfe0e687fc13d916e68060b99c9aa13e7252309/bin" class="js-slide-to" id="fac5fdd68b1daf4e0b63c0847b31387c582d4a0f">bin/</a></td>
            
            <td class="age"> <span class="relatize">Fri Oct 16 16:29:46 -0700 2009</span> </td>
            <td class="message"> <a href="/assaf/necktie/commit/73e4b37945171143c266198f54c76a75e761c108" class="message" title="More better docs.">More better docs.</a> [<a href="/assaf">assaf</a>] </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="directory" src="https://assets1.github.com/images/icons/dir.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/tree/0bfe0e687fc13d916e68060b99c9aa13e7252309/example" class="js-slide-to" id="dfe3d3c7242f3cf7e26ee512a83da07bd58a21bd">example/</a></td>
            
            <td class="age"> <span class="relatize">Mon Apr 12 12:41:11 -0700 2010</span> </td>
            <td class="message"> <a href="/assaf/necktie/commit/0bfe0e687fc13d916e68060b99c9aa13e7252309" class="message" title="Changed: Capistrano can pull from one of these locations ($ denotes variable):">Changed: Capistrano can pull from one of these ...</a> [<a href="/assaf">assaf</a>] </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="directory" src="https://assets1.github.com/images/icons/dir.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/tree/0bfe0e687fc13d916e68060b99c9aa13e7252309/lib" class="js-slide-to" id="f0d77f61b63f513981e009de94cf766c53f52643">lib/</a></td>
            
            <td class="age">  </td>
            <td class="message"> <span class="js-loading-commit-data">Loading commit data... <img src="/images/modules/ajax/indicator.gif"/></span> </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="directory" src="https://assets1.github.com/images/icons/dir.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/tree/0bfe0e687fc13d916e68060b99c9aa13e7252309/vendor" class="js-slide-to" id="ced8cd5aa4ad604e98ecd9bbdb9f0153a51490c0">vendor/</a></td>
            
            <td class="age">  </td>
            <td class="message">  </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="file" src="https://assets2.github.com/images/icons/txt.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/blob/0bfe0e687fc13d916e68060b99c9aa13e7252309/.gitignore" class="js-slide-to" id="aca7c1c147c839f91748171fb82cd0a9917b3d81">.gitignore</a></td>
            
            <td class="age"> <span class="relatize">Wed Nov 04 15:39:15 -0800 2009</span> </td>
            <td class="message"> <a href="/assaf/necktie/commit/b1ab7cb595cc2ee1a661bf1352c177f2e80d4328" class="message" title="Adds rake rdoc task, mostly fixes taken from Vanity.">Adds rake rdoc task, mostly fixes taken from Va...</a> [<a href="/assaf">assaf</a>] </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="file" src="https://assets2.github.com/images/icons/txt.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/blob/0bfe0e687fc13d916e68060b99c9aa13e7252309/CHANGELOG" class="js-slide-to" id="d5133b1cae925702c8de4d8b8ab2d891c2b8de93">CHANGELOG</a></td>
            
            <td class="age">  </td>
            <td class="message">  </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="file" src="https://assets2.github.com/images/icons/txt.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/blob/0bfe0e687fc13d916e68060b99c9aa13e7252309/README.rdoc" class="js-slide-to" id="139574a760f6cb5d2c5b275693758b834dc69941">README.rdoc</a></td>
            
            <td class="age">  </td>
            <td class="message">  </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="file" src="https://assets2.github.com/images/icons/txt.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/blob/0bfe0e687fc13d916e68060b99c9aa13e7252309/Rakefile" class="js-slide-to" id="3ca380d2dd8f26ce18246609840e0ca29470d4e5">Rakefile</a></td>
            
            <td class="age">  </td>
            <td class="message">  </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="file" src="https://assets2.github.com/images/icons/txt.png?52a04f4d5bac1e6525ba43735c8142489bd7a665" /> </td>
            <td class="content"> <a href="/assaf/necktie/blob/0bfe0e687fc13d916e68060b99c9aa13e7252309/necktie.gemspec" class="js-slide-to" id="bc28fcc18df2f8a82529428c5d55a44ddbedef1d">necktie.gemspec</a></td>
            
            <td class="age">  </td>
            <td class="message">  </td>
          </tr>
        
      </table>
    </div>
  </div>
  <br style="clear:both;">


<br style="clear:both;">

<div class="frame frame-loading" style="display:none;">
  <img src="/images/modules/ajax/big_spinner_336699.gif">
</div>
    

  

      
    <div id="readme" class="announce rdoc" data-path="/"><span class="name">README.rdoc</span><div class="wikistyle"><h1>Minimalistic server configuration tool</h1>
<p>
Necktie is tool for running configuration tasks: setting up new servers and
upgrading production servers. You can use it to manage services, mount
volumes, change configuration, manage cronjobs, etc.
</p>
<p>
<img src="https://assets2.github.com/img/f2aa4ce560b42dad7d8f6972b04a6e9acef3746f?repo=&amp;url=http%3A%2F%2F19.media.tumblr.com%2Ftumblr_kspcaa4Djr1qzo4cfo1_250.jpg&amp;path="></p>
<p>
To install Necktie:
</p>
<pre>
  $ gem install necktie --source http://gemcutter.org
</pre>
<p>
To use Necktie:
</p>
<ol>
<li>Write a Necktie file with configurtaion tasks

</li>
<li>Include any support files: config, scripts, binaries, etc

</li>
<li>git push &amp;&amp; cap necktie

</li>
</ol><p>
Introduction to Necktie: <a href="http://blog.labnotes.org/2009/11/04/necktie-dress-to-impress">blog.labnotes.org/2009/11/04/necktie-dress-to-impress</a>/
</p>
<h2>Tasking</h2>
<p>
Necktie is based on Rake, so if you know Rake you already know most of
Necktie. This document will teach you the rest.
</p>
<p>
At the base of your Necktie project there’s a file called Necktie (or
necktie, or necktie.rb), with a list of tasks. For example:
</p>
<pre>
  file "/var/myapp" do
    append "/etc/fstab", "/mnt/myapp /var/myapp none bind\n" unless read("/etc/fstab")["/mnt/myapp"]
    mkdir_p "/var/myapp/"
    sh "mount /var/myapp"
  end

  desc "Install/update ruby gems"
  task :rubygems do
    FileList["gems/*.gem"].each do |gem|
      install_gem gem
    end
    sh "gem clean"
  end

  desc "Setup and start Nginx"
  task :nginx do
    rm_rf "/etc/nginx/sites-enabled/*"
    cp "etc/nginx/unicorn.conf", "/etc/nginx/sites-available/"
    ln_sf "/etc/nginx/sites-available/unicorn.conf", "/etc/nginx/sites-enabled/"
    services.start "nginx"
  end

  desc "Setup and start Unicorn"
  task :unicorn=&gt;[:rubygems, "/var/myapp"] do
    cp "etc/init.d/unicorn", "/etc/init.d/"
    chmod 0750, "/etc/init.d/unicorn"
  end

  desc "Perform all tasks for the role app"
  task :app=&gt;["/var/myapp", :nginx, :unicorn]
</pre>
<p>
When you run the app task, it runs the tasks that setup the application
directory, install gems, configure Nginx and Unicorn. When it’s done,
you’re ready to deploy.
</p>
<p>
Necktie deals with initial configuration, and also ongoing maintenance. Say
you change a configuration file, or add another Gem to the gems directory.
Push these changes into your Git repository and run Necktime again. That
simple.
</p>
<p>
Note: In the example above, the nginx and unicorn tasks run each time, you
can use them to push out new configurations. In contrast, the /var/myapp
file task only runs once, before that directory exists.
</p>
<h2>cap necktie</h2>
<p>
I use Capistrano to setup new instances and upgrade existing ones.
</p>
<p>
You can store your Necktie files in a separate repository, or same
repository as your application but in a separate branch.
</p>
<p>
If using a separate repository, set the variable necktie_url to the URL of
the Necktie repository. You can also set necktie_branch to particular
branch name, the default is master.
</p>
<p>
For example:
</p>
<pre>
  require "necktie/capistrano"
  set :necktie_url, "git@example.com:mysetup"
</pre>
<p>
If using the same repository and separate branch, do not set necktie_url.
You can set necktie_branch to a particular branch name, the default in this
case is necktie. You still need to require "necktie/capistrano".
</p>
<p>
To create a new empty branch for Necktie that will live in the same
repository as your application (note: make sure to commit all changes
first, or you’ll lose them):
</p>
<pre>
  $ git symbolic-ref HEAD refs/heads/necktie
  $ rm .git/index
  $ git clean -fdx
  $ echo "# My Necktie file" &gt; Necktie
  $ git add .
  $ git commit -a -m "First commit"
  $ git push origin necktie
</pre>
<p>
Rather than switching back and forth, you can clone this repository within
your application’s working directory:
</p>
<pre>
  $ cd myapp
  $ git clone -b necktie git:myapp.git .necktie
  $ ls necktie
</pre>
<p>
Setting up a new EC2 instance:
</p>
<pre>
  cap necktie ROLES=app HOSTS=ec2-75-101-239-12.compute-1.amazonaws.com
</pre>
<p>
Upgrading running instances with new configuration:
</p>
<pre>
  git push &amp;&amp; cap necktie
</pre>
<h2>Feel the rush</h2>
<p>
Necktie includes Rush, so you can write tasks like this:
</p>
<pre>
  task :memcached do
    unless processes.find { |p| p.cmdline[/memcached\s.*-l\s0.0.0.0/] }
      box["/etc/memcached.conf"].replace_contents! /^-l 127.0.0.1/, "-l 0.0.0.0"
      services.start "memcached"
    end
  end
</pre>
<p>
You can learn more about Rush here: <a href="http://rush.heroku.com">rush.heroku.com</a>
</p>
<p>
Of course, there’s also FileUtils, system and sh (courtesy of Rake),
so you can also:
</p>
<pre>
  # Update whenever we have a newer config file.
  file "/etc/nginx/nginx.conf"=&gt;"etc/nginx.conf" do
    cp "etc/nginx.conf", "/etc/nginx/nginx.conf"
    sh "service nginx restart"
  end
</pre>
<p>
The current directory (Dir.pwd and launch_dir) is the root directory of
your Necktie repository. You can depend on relative paths when accessing
files in your Necktie repository.
</p>
<h2>Role play</h2>
<p>
If you have different setups, split them into roles and give each role its
own main task. Have that main task depend on all the specific setup tasks
for this role. For example:
</p>
<pre>
  task :app=&gt;[:rubygems, :nginx, :unicorn, "/var/myapp"]
  task :db=&gt;[:mount, :master, :backup]
</pre>
<p>
You can then run Necktie with a list of roles. I recommend using the same
roles with Necktie and Capistrano, that way you can:
</p>
<pre>
  cap necktie ROLES=app,db
</pre>
<p>
This usage will pass the role names as task names to the necktie command.
</p>
<p>
If you have only one role, or work frequently with a given role, you can
define the default task instead of setting ROLES each time. In your Necktie
file add:
</p>
<pre>
  task :default=&gt;:app
</pre>
<p>
You may also want to take advantage of different environments, customizing
your setup differently between production, staging, etc.
</p>
<p>
Check the example directory for ideas on how to split large configurations
into smaller files and tasks.
</p>
<p>
Note: As with Rake, command line arguments are either options (see necktie
-H), task names (executed in order), or name=value pairs that set
environment variables (e.g. RAILS_ENV=production).
</p>
<h2>gem install</h2>
<p>
You can use install_gem in one of two ways. You can pass it a gem name and
version requirement. For example:
</p>
<pre>
  install_gem "unicorn", "~= 0.93"
</pre>
<p>
You can store the gem file in your Necktie repository and install it from
there:
</p>
<pre>
  install_gem "gems/unicorn-0.93.3.gem"
</pre>
<p>
I prefer the later, not depending on the Gem servers being online when I
decide to upgrade.
</p>
<p>
Since install_gem will only install the same gem/version once, a run-always
rubygems.rb task is all you need:
</p>
<pre>
  task :rubygems do
    Dir["gems/*.gem"].each do |gem|
      install_gem gem
    end
  end
</pre>
<h2>One on one</h2>
<p>
You can also run Necktie from the command line directly on the server
you’re configuring. The first time you run Necktie, it clones the Git
repository into the ~/.necktie directory. You’ll need to give it the
Git URL, like this:
</p>
<pre>
  necktie --source git@example.com:mysetup app
</pre>
<p>
Subsequent runs use that repository. You can launch the necktie command
from anywhere, it will always switch to the ~/.necktie directory, run the
tasks and switch back to the previous working directory.
</p>
<p>
If you want to pull changes from the Git repository, use the -U option:
</p>
<pre>
  necktie -U app
</pre>
<p>
If you have read/write access to the Git repository you use that to tweak
and add new tasks, and test them out before using your setup in production.
</p>
<h2>License</h2>
<p>
Necktie, copyright (C) 2009 Assaf Arkin, released under the "Use for
good, not evil" license (<a href="http://www.json.org/license.html">www.json.org/license.html</a>)
</p>
<p>
Includes Rake, created by Jim Weirich and released under the MIT license <a href="http://rake.rubyforge.org">rake.rubyforge.org</a>/ <a href="http://github.com/jimweirich/rake">github.com/jimweirich/rake</a>
</p>
<p>
Includes Rush, created by Adam Wiggins and released under the MIT License
<a href="http://rush.heroku.com">rush.heroku.com</a> <a href="http://github.com/adamwiggins/rush">github.com/adamwiggins/rush</a>
</p>
<p>
Includes Session, created by Ara T. Howard and released under the Ruby
License <a href="http://raa.ruby-lang.org/project/session">raa.ruby-lang.org/project/session</a>
<a href="http://www.codeforpeople.com/lib/ruby/session">www.codeforpeople.com/lib/ruby/session</a>
</p>
<p>
Atomic file write adapted from Rails.
</p>
<p>
ERB task adapted from Luke Bayes <a href="http://gist.github.com/215270">gist.github.com/215270</a>.
</p>
<p>
Developed for managing EC2 instances for <a href="http://apartly.com">apartly.com</a>
</p></div></div>
  </div>



    </div>
  
      
    </div>

    <div id="footer" class="clearfix">
      <div class="site">
        <div class="sponsor">
          <a href="http://www.rackspace.com" class="logo">
            <img alt="Dedicated Server" src="https://assets3.github.com/images/modules/footer/rackspace_logo.png?v2?52a04f4d5bac1e6525ba43735c8142489bd7a665" />
          </a>
          Powered by the <a href="http://www.rackspace.com ">Dedicated
          Servers</a> and<br/> <a href="http://www.rackspacecloud.com">Cloud
          Computing</a> of Rackspace Hosting<span>&reg;</span>
        </div>

        <ul class="links">
          <li class="blog"><a href="https://github.com/blog">Blog</a></li>
          <li><a href="http://support.github.com">Support</a></li>
          <li><a href="https://github.com/training">Training</a></li>
          <li><a href="http://jobs.github.com">Job Board</a></li>
          <li><a href="http://shop.github.com">Shop</a></li>
          <li><a href="https://github.com/contact">Contact</a></li>
          <li><a href="http://develop.github.com">API</a></li>
          <li><a href="http://status.github.com">Status</a></li>
        </ul>
        <ul class="sosueme">
          <li class="main">&copy; 2010 <span id="_rrt" title="0.18513s from fe5.rs.github.com">GitHub</span> Inc. All rights reserved.</li>
          <li><a href="/site/terms">Terms of Service</a></li>
          <li><a href="/site/privacy">Privacy</a></li>
          <li><a href="https://github.com/security">Security</a></li>
        </ul>
      </div>
    </div><!-- /#footer -->

    
      
      
        <!-- current locale:  -->
        <div class="locales">
          <div class="site">

            <ul class="choices clearfix limited-locales">
              <li><span class="current">English</span></li>
              
                  <li><a rel="nofollow" href="?locale=de">Deutsch</a></li>
              
                  <li><a rel="nofollow" href="?locale=fr">Français</a></li>
              
                  <li><a rel="nofollow" href="?locale=ja">日本語</a></li>
              
                  <li><a rel="nofollow" href="?locale=pt-BR">Português (BR)</a></li>
              
                  <li><a rel="nofollow" href="?locale=ru">Русский</a></li>
              
                  <li><a rel="nofollow" href="?locale=zh">中文</a></li>
              
              <li class="all"><a href="#" class="minibutton btn-forward js-all-locales"><span><span class="icon"></span>See all available languages</span></a></li>
            </ul>

            <div class="all-locales clearfix">
              <h3>Your current locale selection: <strong>English</strong>. Choose another?</h3>
              
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=en">English</a></li>
                  
                      <li><a rel="nofollow" href="?locale=af">Afrikaans</a></li>
                  
                      <li><a rel="nofollow" href="?locale=ca">Català</a></li>
                  
                      <li><a rel="nofollow" href="?locale=cs">Čeština</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=de">Deutsch</a></li>
                  
                      <li><a rel="nofollow" href="?locale=es">Español</a></li>
                  
                      <li><a rel="nofollow" href="?locale=fr">Français</a></li>
                  
                      <li><a rel="nofollow" href="?locale=hr">Hrvatski</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=id">Indonesia</a></li>
                  
                      <li><a rel="nofollow" href="?locale=it">Italiano</a></li>
                  
                      <li><a rel="nofollow" href="?locale=ja">日本語</a></li>
                  
                      <li><a rel="nofollow" href="?locale=nl">Nederlands</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=no">Norsk</a></li>
                  
                      <li><a rel="nofollow" href="?locale=pl">Polski</a></li>
                  
                      <li><a rel="nofollow" href="?locale=pt-BR">Português (BR)</a></li>
                  
                      <li><a rel="nofollow" href="?locale=ru">Русский</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=sr">Српски</a></li>
                  
                      <li><a rel="nofollow" href="?locale=sv">Svenska</a></li>
                  
                      <li><a rel="nofollow" href="?locale=zh">中文</a></li>
                  
                </ul>
              
            </div>

          </div>
          <div class="fade"></div>
        </div>
      
    

    <script>window._auth_token = "d0410eef863baff064a950b7329753a7c5bc1cac"</script>
    <div id="keyboard_shortcuts_pane" style="display:none">
  <h2>Keyboard Shortcuts</h2>

  <div class="columns threecols">
    <div class="column first">
      <h3>Site wide shortcuts</h3>
      <dl class="keyboard-mappings">
        <dt>s</dt>
        <dd>Focus site search</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>?</dt>
        <dd>Bring up this help dialog</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column middle">
      <h3>Commit list</h3>
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selected down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selected up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>t</dt>
        <dd>Open tree</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>p</dt>
        <dd>Open parent</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>c <em>or</em> o <em>or</em> enter</dt>
        <dd>Open commit</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column last">
      <h3>Pull request list</h3>
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selected down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selected up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>o <em>or</em> enter</dt>
        <dd>Open issue</dd>
      </dl>
    </div><!-- /.columns.last -->
  </div><!-- /.columns.equacols -->

  <div class="rule"></div>

  <h3>Issues</h3>

  <div class="columns threecols">
    <div class="column first">
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selected down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selected up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>x</dt>
        <dd>Toggle select target</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>o <em>or</em> enter</dt>
        <dd>Open issue</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column middle">
      <dl class="keyboard-mappings">
        <dt>I</dt>
        <dd>Mark selected as read</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>U</dt>
        <dd>Mark selected as unread</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>e</dt>
        <dd>Close selected</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>y</dt>
        <dd>Remove selected from view</dd>
      </dl>
    </div><!-- /.column.middle -->
    <div class="column last">
      <dl class="keyboard-mappings">
        <dt>c</dt>
        <dd>Create issue</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>l</dt>
        <dd>Create label</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>i</dt>
        <dd>Back to inbox</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>u</dt>
        <dd>Back to issues</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>/</dt>
        <dd>Focus issues search</dd>
      </dl>
    </div>
  </div>

  <div class="rule"></div>

  <h3>Network Graph</h3>
  <div class="columns equacols">
    <div class="column first">
      <dl class="keyboard-mappings">
        <dt>← <em>or</em> h</dt>
        <dd>Scroll left</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>→ <em>or</em> l</dt>
        <dd>Scroll right</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>↑ <em>or</em> k</dt>
        <dd>Scroll up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>↓ <em>or</em> j</dt>
        <dd>Scroll down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>t</dt>
        <dd>Toggle visibility of head labels</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column last">
      <dl class="keyboard-mappings">
        <dt>shift ← <em>or</em> shift h</dt>
        <dd>Scroll all the way left</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>shift → <em>or</em> shift l</dt>
        <dd>Scroll all the way right</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>shift ↑ <em>or</em> shift k</dt>
        <dd>Scroll all the way up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>shift ↓ <em>or</em> shift j</dt>
        <dd>Scroll all the way down</dd>
      </dl>
    </div><!-- /.column.last -->
  </div>

</div>
    

    <!--[if IE 8]>
    <script type="text/javascript" charset="utf-8">
      $(document.body).addClass("ie8")
    </script>
    <![endif]-->

    <!--[if IE 7]>
    <script type="text/javascript" charset="utf-8">
      $(document.body).addClass("ie7")
    </script>
    <![endif]-->

    <script type="text/javascript">
      _kmq.push(['trackClick', 'entice-signup-button', 'Entice banner clicked']);
      
    </script>
    
  </body>
</html>

