
    

  

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>twitter/twitcher - GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub" />
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub" />

    <link href="https://assets0.github.com/stylesheets/bundle_common.css?52a04f4d5bac1e6525ba43735c8142489bd7a665" media="screen" rel="stylesheet" type="text/css" />
<link href="https://assets3.github.com/stylesheets/bundle_github.css?52a04f4d5bac1e6525ba43735c8142489bd7a665" media="screen" rel="stylesheet" type="text/css" />

    <script type="text/javascript" charset="utf-8">
      var GitHub = {}
      var github_user = null
      
    </script>
    <script src="https://assets1.github.com/javascripts/jquery/jquery-1.4.2.min.js?52a04f4d5bac1e6525ba43735c8142489bd7a665" type="text/javascript"></script>
    <script src="https://assets1.github.com/javascripts/bundle_common.js?52a04f4d5bac1e6525ba43735c8142489bd7a665" type="text/javascript"></script>
<script src="https://assets2.github.com/javascripts/bundle_github.js?52a04f4d5bac1e6525ba43735c8142489bd7a665" type="text/javascript"></script>


        <script type="text/javascript" charset="utf-8">
      GitHub.spy({
        repo: "twitter/twitcher"
      })
    </script>

    
  
    
  

  <link href="https://github.com/twitter/twitcher/commits/master.atom" rel="alternate" title="Recent Commits to twitcher:master" type="application/atom+xml" />

        <meta name="description" content="A tool for executing scripts when ZooKeeper nodes change." />
    <script type="text/javascript">
      GitHub.nameWithOwner = GitHub.nameWithOwner || "twitter/twitcher";
      GitHub.currentRef = 'master';
      GitHub.commitSHA = "edd581fb6e848f3f37476eab678bbfc9c5ee7a79";
      GitHub.currentPath = "";
      GitHub.masterBranch = "master";

      
        GitHub.currentTreeSHA = "edd581fb6e848f3f37476eab678bbfc9c5ee7a79";
      
    </script>
  

            <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-3769691-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script');
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        ga.setAttribute('async', 'true');
        document.documentElement.firstChild.appendChild(ga);
      })();
    </script>

  </head>

  

  <body class="logged_out ">
    

    
      <script type="text/javascript">
        var _kmq = _kmq || [];
        function _kms(u){
          var s = document.createElement('script'); var f = document.getElementsByTagName('script')[0]; s.type = 'text/javascript'; s.async = true;
          s.src = u; f.parentNode.insertBefore(s, f);
        }
        _kms('//i.kissmetrics.com/i.js');_kms('//doug1izaerwt3.cloudfront.net/406e8bf3a2b8846ead55afb3cfaf6664523e3a54.1.js');
      </script>
    

    

    

    

    <div class="subnavd" id="main">
      <div id="header" class="true">
        
          <a class="logo boring" href="https://github.com">
            <img src="/images/modules/header/logov3.png?changed" class="default" alt="github" />
            <![if !IE]>
            <img src="/images/modules/header/logov3-hover.png" class="hover" alt="github" />
            <![endif]>
          </a>
        
        
        <div class="topsearch">
  
    <ul class="nav logged_out">
      <li class="pricing"><a href="/plans">Pricing and Signup</a></li>
      <li><a href="/explore">Explore GitHub</a></li>
      <li><a href="/features">Features</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="https://github.com/login">Login</a></li>
    </ul>
  
</div>

      </div>

      
      
        
    <div class="site">
      <div class="pagehead repohead vis-public fork  ">

      

      <div class="title-actions-bar">
        <h1>
          <a href="/twitter">twitter</a> / <strong><a href="https://github.com/twitter/twitcher">twitcher</a></strong>
          
            <span class="fork-flag">
              
              <span class="text">forked from <a href="/liquidgecka/twitcher">liquidgecka/twitcher</a></span>
            </span>
          
          
        </h1>

        
    <ul class="actions">
      

      
        <li class="for-owner" style="display:none"><a href="https://github.com/twitter/twitcher/admin" class="minibutton btn-admin "><span><span class="icon"></span>Admin</span></a></li>
        <li>
          <a href="/twitter/twitcher/toggle_watch" class="minibutton btn-watch " id="watch_button" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', '229f06e2e26db50742952d56c0fbbb31406962ef'); f.appendChild(s);f.submit();return false;" style="display:none"><span><span class="icon"></span>Watch</span></a>
          <a href="/twitter/twitcher/toggle_watch" class="minibutton btn-watch " id="unwatch_button" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', '229f06e2e26db50742952d56c0fbbb31406962ef'); f.appendChild(s);f.submit();return false;" style="display:none"><span><span class="icon"></span>Unwatch</span></a>
        </li>
        
          
            <li class="for-notforked" style="display:none"><a href="/twitter/twitcher/fork" class="minibutton btn-fork " id="fork_button" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', '229f06e2e26db50742952d56c0fbbb31406962ef'); f.appendChild(s);f.submit();return false;"><span><span class="icon"></span>Fork</span></a></li>
            <li class="for-hasfork" style="display:none"><a href="#" class="minibutton btn-fork " id="your_fork_button"><span><span class="icon"></span>Your Fork</span></a></li>
          

          
        
      
      
      <li class="repostats">
        <ul class="repo-stats">
          <li class="watchers"><a href="/twitter/twitcher/watchers" title="Watchers" class="tooltipped downwards">20</a></li>
          <li class="forks"><a href="/twitter/twitcher/network" title="Forks" class="tooltipped downwards">3</a></li>
        </ul>
      </li>
    </ul>

      </div>

        
  <ul class="tabs">
    <li><a href="https://github.com/twitter/twitcher" class="selected" highlight="repo_source">Source</a></li>
    <li><a href="https://github.com/twitter/twitcher/commits/master" highlight="repo_commits">Commits</a></li>
    <li><a href="/twitter/twitcher/network" highlight="repo_network">Network</a></li>
    <li><a href="/twitter/twitcher/pulls" highlight="repo_pulls">Pull Requests (0)</a></li>

    

    

            
    <li><a href="/twitter/twitcher/graphs" highlight="repo_graphs">Graphs</a></li>

    <li class="contextswitch nochoices">
      <span class="toggle leftwards" >
        <em>Branch:</em>
        <code>master</code>
      </span>
    </li>
  </ul>

  <div style="display:none" id="pl-description"><p><em class="placeholder">click here to add a description</em></p></div>
  <div style="display:none" id="pl-homepage"><p><em class="placeholder">click here to add a homepage</em></p></div>

  <div class="subnav-bar">
  
  <ul>
    <li>
      <a href="#" class="dropdown">Switch Branches (1)</a>
      <ul>
        
          
            <li><strong>master &#x2713;</strong></li>
            
      </ul>
    </li>
    <li>
      <a href="#" class="dropdown defunct">Switch Tags (0)</a>
      
    </li>
    <li>
    
    <a href="/twitter/twitcher/branches" class="manage">Branch List</a>
    
    </li>
  </ul>
</div>

  
  
  
  
  
  



        
    <div id="repo_details" class="metabox clearfix">
      <div id="repo_details_loader" class="metabox-loader" style="display:none">Sending Request&hellip;</div>

        <a href="/twitter/twitcher/downloads" class="download-source" id="download_button" title="Download source, tagged packages and binaries."><span class="icon"></span>Downloads</a>

      <div id="repository_desc_wrapper">
      <div id="repository_description" rel="repository_description_edit">
        
          <p>A tool for executing scripts when ZooKeeper nodes change.
            <span id="read_more" style="display:none">&mdash; <a href="#readme">Read more</a></span>
          </p>
        
      </div>

      <div id="repository_description_edit" style="display:none;" class="inline-edit">
        <form action="/twitter/twitcher/admin/update" method="post"><div style="margin:0;padding:0"><input name="authenticity_token" type="hidden" value="229f06e2e26db50742952d56c0fbbb31406962ef" /></div>
          <input type="hidden" name="field" value="repository_description">
          <input type="text" class="textfield" name="value" value="A tool for executing scripts when ZooKeeper nodes change.">
          <div class="form-actions">
            <button class="minibutton"><span>Save</span></button> &nbsp; <a href="#" class="cancel">Cancel</a>
          </div>
        </form>
      </div>

      
      <div class="repository-homepage" id="repository_homepage" rel="repository_homepage_edit">
        <p><a href="http://" rel="nofollow"></a></p>
      </div>

      <div id="repository_homepage_edit" style="display:none;" class="inline-edit">
        <form action="/twitter/twitcher/admin/update" method="post"><div style="margin:0;padding:0"><input name="authenticity_token" type="hidden" value="229f06e2e26db50742952d56c0fbbb31406962ef" /></div>
          <input type="hidden" name="field" value="repository_homepage">
          <input type="text" class="textfield" name="value" value="">
          <div class="form-actions">
            <button class="minibutton"><span>Save</span></button> &nbsp; <a href="#" class="cancel">Cancel</a>
          </div>
        </form>
      </div>
      </div>
      <div class="rule "></div>
            <div id="url_box" class="url-box">
        <ul class="clone-urls">
          
            
            <li id="http_clone_url"><a href="https://github.com/twitter/twitcher.git" data-permissions="Read-Only">HTTP</a></li>
            <li id="public_clone_url"><a href="git://github.com/twitter/twitcher.git" data-permissions="Read-Only">Git Read-Only</a></li>
          
          
        </ul>
        <input type="text" spellcheck="false" id="url_field" class="url-field" />
              <span style="display:none" id="url_box_clippy"></span>
      <span id="clippy_tooltip_url_box_clippy" class="clippy-tooltip tooltipped" title="copy to clipboard">
      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
              width="14"
              height="14"
              class="clippy"
              id="clippy" >
      <param name="movie" value="https://assets1.github.com/flash/clippy.swf?v5"/>
      <param name="allowScriptAccess" value="always" />
      <param name="quality" value="high" />
      <param name="scale" value="noscale" />
      <param NAME="FlashVars" value="id=url_box_clippy&amp;copied=&amp;copyto=">
      <param name="bgcolor" value="#FFFFFF">
      <param name="wmode" value="opaque">
      <embed src="https://assets1.github.com/flash/clippy.swf?v5"
             width="14"
             height="14"
             name="clippy"
             quality="high"
             allowScriptAccess="always"
             type="application/x-shockwave-flash"
             pluginspage="http://www.macromedia.com/go/getflashplayer"
             FlashVars="id=url_box_clippy&amp;copied=&amp;copyto="
             bgcolor="#FFFFFF"
             wmode="opaque"
      />
      </object>
      </span>

        <p id="url_description">This URL has <strong>Read+Write</strong> access</p>
      </div>
    </div>


        

      </div><!-- /.pagehead -->

      









<script type="text/javascript">
  GitHub.currentCommitRef = 'master'
  GitHub.currentRepoOwner = 'twitter'
  GitHub.currentRepo = "twitcher"
  GitHub.downloadRepo = '/twitter/twitcher/archives/master'
  GitHub.revType = "master"

  GitHub.controllerName = "tree"
  GitHub.actionName     = "show"
  GitHub.currentAction  = "tree#show"

  

  
</script>








  <div id="commit">
    <div class="group">
        
  <div class="envelope commit">
    <div class="human">
      
        <div class="message"><pre><a href="/twitter/twitcher/commit/edd581fb6e848f3f37476eab678bbfc9c5ee7a79">Use verbose logging</a> </pre></div>
      

      <div class="actor">
        <div class="gravatar">
          
          <img src="https://secure.gravatar.com/avatar/02e186b5a3ecc5fb67121c5f24201f8c?s=140&d=https%3A%2F%2Fgithub.com%2Fimages%2Fgravatars%2Fgravatar-140.png" alt="" width="30" height="30"  />
        </div>
        <div class="name"><a href="/traviscrawford">traviscrawford</a> <span>(author)</span></div>
        <div class="date">
          <abbr class="relatize" title="2010-11-16 09:45:09">Tue Nov 16 09:45:09 -0800 2010</abbr>
        </div>
      </div>

      

    </div>
    <div class="machine">
      <span>c</span>ommit&nbsp;&nbsp;<a href="/twitter/twitcher/commit/edd581fb6e848f3f37476eab678bbfc9c5ee7a79" hotkey="c">edd581fb6e848f3f3747</a><br />
      <span>t</span>ree&nbsp;&nbsp;&nbsp;&nbsp;<a href="/twitter/twitcher/tree/edd581fb6e848f3f37476eab678bbfc9c5ee7a79" hotkey="t">3cb406e9ee90e81b7aeb</a><br />
      
        <span>p</span>arent&nbsp;
        
        <a href="/twitter/twitcher/tree/b73a447bf88b5e4832ff1a104eddaaa59b221d20" hotkey="p">b73a447bf88b5e4832ff</a>
      

    </div>
  </div>

    </div>
  </div>



<div id="slider">
  
    <div class="breadcrumb" data-path="/">
      <b><a href="/twitter/twitcher/tree/edd581fb6e848f3f37476eab678bbfc9c5ee7a79">twitcher</a></b> / 
    </div>

    
      


  <div class="frames">
    <div class="frame frame-center" data-path="/">
      <table id="browser" cellpadding="0" cellspacing="0">
        <tr class="header">
          <th></th>
          <th>name</th>
          <th>age</th>
          <th>
            <div class="history">
              <a href="/twitter/twitcher/commits/master/">history</a>
            </div>
            message
          </th>
        </tr>

        

        
        
                    <tr class="alt">
            <td class="icon"> <img alt="directory" src="https://assets3.github.com/images/icons/dir.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/tree/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/bin" class="js-slide-to" id="1e12da1e3ad1dd18fdcafe8c4aed8f2f8a01fcd9">bin/</a></td>
            
            <td class="age"> <span class="relatize">Thu Sep 02 18:01:45 -0700 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/ce2469569352d4a3fd8b7f9bed747e8fb97977c9" class="message" title="Added ZooKeeper debug logging, and changed the way twitcher is launched so that output is preserved. Added a note saying when twitcher starts to easily find that point in logs.">Added ZooKeeper debug logging, and changed the ...</a> [<a href="/traviscrawford">traviscrawford</a>] </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="directory" src="https://assets3.github.com/images/icons/dir.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/tree/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/config" class="js-slide-to" id="7573de36f58ded318e3b3869806c4908135f3567">config/</a></td>
            
            <td class="age"> <span class="relatize">Sat Jul 17 01:30:37 -0700 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/824753a591d5317c4c1e4d4f8e8c6754b563be50" class="message" title="Initial commit of Twitcher for the public repository.">Initial commit of Twitcher for the public repos...</a> [Brady Catherman] </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="directory" src="https://assets3.github.com/images/icons/dir.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/tree/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/twitcher" class="js-slide-to" id="fed590db4652e4086d00d2dc8ad3110b4ee8801a">twitcher/</a></td>
            
            <td class="age"> <span class="relatize">Mon Nov 15 18:42:28 -0800 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/1cf1b003189e52b1017af501562a35d34afeeb77" class="message" title="Merge remote branch 'github/master' into ca4e032eb1e190d02a6586dc0453cfe3a55f8c82">Merge remote branch 'github/master' into ca4e03...</a> [<a href="/traviscrawford">traviscrawford</a>] </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="file" src="https://assets0.github.com/images/icons/txt.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/blob/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/.gitignore" class="js-slide-to" id="0d20b6487c61e7d1bde93acf4a14b7a89083a16d">.gitignore</a></td>
            
            <td class="age"> <span class="relatize">Fri Jul 30 01:45:39 -0700 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/a059ac125c392040f2b3318b60b49e4676768c4f" class="message" title="Adding *.pyc to .gitignore">Adding *.pyc to .gitignore</a> [<a href="/jtrosby">jtrosby</a>] </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="file" src="https://assets0.github.com/images/icons/txt.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/blob/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/LICENSE" class="js-slide-to" id="3a31398eaa57af334d5aa2409d882823daa73e40">LICENSE</a></td>
            
            <td class="age"> <span class="relatize">Mon Aug 02 16:31:32 -0700 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/2287f0c8c6e61451fd1df6a72196cbf170e1ec0f" class="message" title="Twitcher version bump to 1.3, changes included:">Twitcher version bump to 1.3, changes included:</a> [Brady Catherman] </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="file" src="https://assets0.github.com/images/icons/txt.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/blob/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/README" class="js-slide-to" id="2f533504a7d332288881091763940e06465c87c5">README</a></td>
            
            <td class="age"> <span class="relatize">Mon Nov 08 21:47:47 -0800 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/8dc6012535d9f255dd2a03307eb13095c2531c26" class="message" title="Make reconnections re-establish all watches.">Make reconnections re-establish all watches.</a> [Brady Catherman] </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="file" src="https://assets0.github.com/images/icons/txt.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/blob/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/init-twitcher" class="js-slide-to" id="11c841cc8b964d598f04eb671cd13a5519f8223e">init-twitcher</a></td>
            
            <td class="age"> <span class="relatize">Tue Nov 16 09:45:09 -0800 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/edd581fb6e848f3f37476eab678bbfc9c5ee7a79" class="message" title="Use verbose logging">Use verbose logging</a> [<a href="/traviscrawford">traviscrawford</a>] </td>
          </tr>
        
                    <tr class="">
            <td class="icon"> <img alt="file" src="https://assets0.github.com/images/icons/txt.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/blob/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/makerpm.sh" class="js-slide-to" id="296c7d7a5baedff8cae78832e0eb7c4824bb8b21">makerpm.sh</a></td>
            
            <td class="age"> <span class="relatize">Sat Jul 17 01:30:37 -0700 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/824753a591d5317c4c1e4d4f8e8c6754b563be50" class="message" title="Initial commit of Twitcher for the public repository.">Initial commit of Twitcher for the public repos...</a> [Brady Catherman] </td>
          </tr>
        
                    <tr class="alt">
            <td class="icon"> <img alt="file" src="https://assets0.github.com/images/icons/txt.png?e5f7cb12b442f7ff4513287aafa14768377b2ab9" /> </td>
            <td class="content"> <a href="/twitter/twitcher/blob/edd581fb6e848f3f37476eab678bbfc9c5ee7a79/twitcher.spec" class="js-slide-to" id="3a90f9d0fef7eeeda6a132d1abf99b0c53f2056d">twitcher.spec</a></td>
            
            <td class="age"> <span class="relatize">Tue Nov 16 09:45:09 -0800 2010</span> </td>
            <td class="message"> <a href="/twitter/twitcher/commit/edd581fb6e848f3f37476eab678bbfc9c5ee7a79" class="message" title="Use verbose logging">Use verbose logging</a> [<a href="/traviscrawford">traviscrawford</a>] </td>
          </tr>
        
      </table>
    </div>
  </div>
  <br style="clear:both;">


<br style="clear:both;">

<div class="frame frame-loading" style="display:none;">
  <img src="/images/modules/ajax/big_spinner_336699.gif">
</div>
    

  

      
    <div id="readme" class="announce " data-path="/"><span class="name">README</span><div class="plain"><pre>================
=== Twitcher ===
================

1. License
2. Overview
3. Installation
4. Configuration Language
4.1 Examples
4.2 Things to Avoid
5. Known Issues
6. Future Features
7. Change Log

1. License
==========

This software is licensed under the Apache 2.0 license. Please see LICENSE
in the top level of this git repository for more information.

2. Overview
===========

Twitcher is a minimal tool used to run scripts when a znode in ZooKeeper
changes. The intent is to allow various system tasks to take place on a
watched model rather than via polling.

The best description of Twitcher is to highlight an example that it solves
very well. Lets assume we are facing a problem where we need a single git
repository to be checked out and up to date on 100 machines in a cluster. The
typical solution to this is to add a cron job that performs a git pull every
minute. This can be problematic as your git server has to endure the load of
100 servers performing a pull every minute. You can configure Twitcher on all
machines to watch /git/head on your ZooKeeper instance. When that znode
changes Twitcher can run git pull. Add a post-commit script in your main
git repository that pokes that file and you will be able to fetch updates
within few seconds of a commit on all machines while not requiring constant
fetching when no changes are being made.

3. Installation
===============

The default installation of Twitcher places the twitcher binary (bin/twitcher)
in /usr/sbin and the twitcher module (twicher/*) in the site-packages
directory which is often /usr/lib/python2.6/sites-packages/twitcher.

The configs are read recursively from /etc/twitcher while twitcher is running.

Note that Twitcher uses inofity to update when files change so it can
automatically reload them. This is used to allow quick adding and removing
of configs without restarting the server binary. If a config fails to parse
then it will not be updated in the running binary and a log message will be
written.

By default Twitcher uses syslog under daemon as the default logging method.

4. Configuration Language
=========================

The configuration language for Twitcher is actually just python. Each
configuration must register a znode, and an action for each watch it wants.
This is done via a RegisterWatch function which takes several arguments.

RegisterWatch(): Creates a watch that will run a script when a Zookeeper node
                 is updated.
    znode: This is the znode in ZooKeeper that is to be watched.
    action: This is a function or lambda that will perform an action when
            the znode is modified. The most common use here is to call Exec()
            which is a function documented later.
    pipe_stdin: If True then the contents of 'znode' will be piped to the stdin
                of the processes running action. Default is True.
    run_on_load: If True then the action will be executed when Twitcher starts.
                 Without this your action may miss updates.
                 The default is True.
    run_mode: This defines how Twitcher will react when 'znode' is updated
              while it is running 'action' for a previous update. The optional
              modes are:
                QUEUE: This will queue the watch until the currently running
                       'action' finishes, then run 'action' with the most
                       recent contents. If several watches are received while
                       'action' is running then only the last update will
                       be executed.
                DISCARD: Ignore the update, don't run the script, but
                         re-register the watch.
                PARALLEL: Run the script in parallel for every update received.
              The default run mode is QUEUE.
    uid: The user id to run the process as (string or int). The default is to
         run as root.
    gid: The group id to run the process as (string or int). The default is to
         run as root.
    notify_signal: This is the signal that will be send to the spawned
                   process that is currently running when a new update has
                   been received. By default this is not used, and it will only
                   work if the run_mode is QUEUE.
    timeout: The number of seconds before any spawned process should be sent
             a SIGTERM. Five seconds later the process will be sent a SIGKILL.
    description: This is a text description of the watch which will be used
                 for logging. The default is to name watches after the file
                 they are configured in.

Exec(): Returns a lambda that will execute a given command when run.
    command: If this is a string then the command will be invoked in a
             shell interpreter. If its a list then it will be executed
             exactly as specified.

By default the configuration files should be placed in /etc/twitcher and
should use an extension of ".twc".


4.1. Examples
=============

In this example config a node called '/twitcher/example1' will be watched for
updates, and when it changes it will execute
"date &gt;&gt; /tmp/twitcher_example1.out".

RegisterWatch(
    znode='/twitcher/example1',
    action=Exec('date &gt;&gt; /tmp/twitcher_example1.out')
    )

As another example we can run a python function rather than executing a
command. For this example we will execute the function example2() every time
'/twitcher/example2' is updated.

def example2():
  open('/tmp/twitcher_example2.out', 'w').write('testing')

RegisterWatch(
    znode='/twitcher/example2',
    action=example2
    )

Keep in mind that the action function is run in a process that has been forked
off from the main Twitcher instance. As such the following example
DOES NOT WORK AS EXPECTED. The output will always be 1 since the increment
happens in the child process which exits after doesnotwork() finishes.

x = 0
def doesnotwork():
  global x
  x += 1
  open('/tmp/twitcher_badexample.out', 'w').write(x)

RegisterWatch(
    znode='/twitcher/doesnotwork',
    action=doesnotwork
    )

4.2 Things to Avoid
===================

Any action run by Twitcher is expected to by idempotent. Since the script may
be executed at any time and can be triggered rapidly it is expected that
each script does basic health and sanity checking before performing expensive
or destructive actions.

Even if the script is in QUEUE mode there is a possibility that it may be run
twice. If Twitcher is restarted while the script is running it will then
restart the script when Twitcher restarts which leaves two running at the
same time. In order to prevent this your script should use file based sigil
or other method to verify exclusivity.

5. Known Issues
===============

None at the moment.

6. Future Features
==================

Failure handling on the child process: Allow the config to specify what should
be done in the case where the script fails (returns non zero). Some examples
include "retry x times" "fail but keep watch" "fail and stop watching"

7. Change Log
=============

Release: 1.5

2010/11/08: Make connection re-establish all existing watches.

Release: 1.4

2010/10/25: Fix client session expiration recovery.

2010/8/3: Documentation fixes.

Release: 1.3

2010/8/2: Added notify_signal and timeout support and fix a few bugs.

Release: 1.2, Open source under the Apache 2.0 license.

2010/7/15: Added uid/gid support

Release: 1.1

2010/6/24: Fixed a bug that allowed child processes to get ignored forever.

Release 1.0

2010/6/19: Initial review.
</pre></div></div>
  </div>



    </div>
  
      
    </div>

    <div id="footer" class="clearfix">
      <div class="site">
        <div class="sponsor">
          <a href="http://www.rackspace.com" class="logo">
            <img alt="Dedicated Server" src="https://assets3.github.com/images/modules/footer/rackspace_logo.png?v2?52a04f4d5bac1e6525ba43735c8142489bd7a665" />
          </a>
          Powered by the <a href="http://www.rackspace.com ">Dedicated
          Servers</a> and<br/> <a href="http://www.rackspacecloud.com">Cloud
          Computing</a> of Rackspace Hosting<span>&reg;</span>
        </div>

        <ul class="links">
          <li class="blog"><a href="https://github.com/blog">Blog</a></li>
          <li><a href="http://support.github.com">Support</a></li>
          <li><a href="https://github.com/training">Training</a></li>
          <li><a href="http://jobs.github.com">Job Board</a></li>
          <li><a href="http://shop.github.com">Shop</a></li>
          <li><a href="https://github.com/contact">Contact</a></li>
          <li><a href="http://develop.github.com">API</a></li>
          <li><a href="http://status.github.com">Status</a></li>
        </ul>
        <ul class="sosueme">
          <li class="main">&copy; 2010 <span id="_rrt" title="0.04947s from fe3.rs.github.com">GitHub</span> Inc. All rights reserved.</li>
          <li><a href="/site/terms">Terms of Service</a></li>
          <li><a href="/site/privacy">Privacy</a></li>
          <li><a href="https://github.com/security">Security</a></li>
        </ul>
      </div>
    </div><!-- /#footer -->

    
      
      
        <!-- current locale:  -->
        <div class="locales">
          <div class="site">

            <ul class="choices clearfix limited-locales">
              <li><span class="current">English</span></li>
              
                  <li><a rel="nofollow" href="?locale=de">Deutsch</a></li>
              
                  <li><a rel="nofollow" href="?locale=fr">Français</a></li>
              
                  <li><a rel="nofollow" href="?locale=ja">日本語</a></li>
              
                  <li><a rel="nofollow" href="?locale=pt-BR">Português (BR)</a></li>
              
                  <li><a rel="nofollow" href="?locale=ru">Русский</a></li>
              
                  <li><a rel="nofollow" href="?locale=zh">中文</a></li>
              
              <li class="all"><a href="#" class="minibutton btn-forward js-all-locales"><span><span class="icon"></span>See all available languages</span></a></li>
            </ul>

            <div class="all-locales clearfix">
              <h3>Your current locale selection: <strong>English</strong>. Choose another?</h3>
              
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=en">English</a></li>
                  
                      <li><a rel="nofollow" href="?locale=af">Afrikaans</a></li>
                  
                      <li><a rel="nofollow" href="?locale=ca">Català</a></li>
                  
                      <li><a rel="nofollow" href="?locale=cs">Čeština</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=de">Deutsch</a></li>
                  
                      <li><a rel="nofollow" href="?locale=es">Español</a></li>
                  
                      <li><a rel="nofollow" href="?locale=fr">Français</a></li>
                  
                      <li><a rel="nofollow" href="?locale=hr">Hrvatski</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=id">Indonesia</a></li>
                  
                      <li><a rel="nofollow" href="?locale=it">Italiano</a></li>
                  
                      <li><a rel="nofollow" href="?locale=ja">日本語</a></li>
                  
                      <li><a rel="nofollow" href="?locale=nl">Nederlands</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=no">Norsk</a></li>
                  
                      <li><a rel="nofollow" href="?locale=pl">Polski</a></li>
                  
                      <li><a rel="nofollow" href="?locale=pt-BR">Português (BR)</a></li>
                  
                      <li><a rel="nofollow" href="?locale=ru">Русский</a></li>
                  
                </ul>
              
                <ul class="choices">
                  
                      <li><a rel="nofollow" href="?locale=sr">Српски</a></li>
                  
                      <li><a rel="nofollow" href="?locale=sv">Svenska</a></li>
                  
                      <li><a rel="nofollow" href="?locale=zh">中文</a></li>
                  
                </ul>
              
            </div>

          </div>
          <div class="fade"></div>
        </div>
      
    

    <script>window._auth_token = "229f06e2e26db50742952d56c0fbbb31406962ef"</script>
    <div id="keyboard_shortcuts_pane" style="display:none">
  <h2>Keyboard Shortcuts</h2>

  <div class="columns threecols">
    <div class="column first">
      <h3>Site wide shortcuts</h3>
      <dl class="keyboard-mappings">
        <dt>s</dt>
        <dd>Focus site search</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>?</dt>
        <dd>Bring up this help dialog</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column middle">
      <h3>Commit list</h3>
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selected down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selected up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>t</dt>
        <dd>Open tree</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>p</dt>
        <dd>Open parent</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>c <em>or</em> o <em>or</em> enter</dt>
        <dd>Open commit</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column last">
      <h3>Pull request list</h3>
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selected down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selected up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>o <em>or</em> enter</dt>
        <dd>Open issue</dd>
      </dl>
    </div><!-- /.columns.last -->
  </div><!-- /.columns.equacols -->

  <div class="rule"></div>

  <h3>Issues</h3>

  <div class="columns threecols">
    <div class="column first">
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selected down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selected up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>x</dt>
        <dd>Toggle select target</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>o <em>or</em> enter</dt>
        <dd>Open issue</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column middle">
      <dl class="keyboard-mappings">
        <dt>I</dt>
        <dd>Mark selected as read</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>U</dt>
        <dd>Mark selected as unread</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>e</dt>
        <dd>Close selected</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>y</dt>
        <dd>Remove selected from view</dd>
      </dl>
    </div><!-- /.column.middle -->
    <div class="column last">
      <dl class="keyboard-mappings">
        <dt>c</dt>
        <dd>Create issue</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>l</dt>
        <dd>Create label</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>i</dt>
        <dd>Back to inbox</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>u</dt>
        <dd>Back to issues</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>/</dt>
        <dd>Focus issues search</dd>
      </dl>
    </div>
  </div>

  <div class="rule"></div>

  <h3>Network Graph</h3>
  <div class="columns equacols">
    <div class="column first">
      <dl class="keyboard-mappings">
        <dt>← <em>or</em> h</dt>
        <dd>Scroll left</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>→ <em>or</em> l</dt>
        <dd>Scroll right</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>↑ <em>or</em> k</dt>
        <dd>Scroll up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>↓ <em>or</em> j</dt>
        <dd>Scroll down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>t</dt>
        <dd>Toggle visibility of head labels</dd>
      </dl>
    </div><!-- /.column.first -->
    <div class="column last">
      <dl class="keyboard-mappings">
        <dt>shift ← <em>or</em> shift h</dt>
        <dd>Scroll all the way left</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>shift → <em>or</em> shift l</dt>
        <dd>Scroll all the way right</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>shift ↑ <em>or</em> shift k</dt>
        <dd>Scroll all the way up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>shift ↓ <em>or</em> shift j</dt>
        <dd>Scroll all the way down</dd>
      </dl>
    </div><!-- /.column.last -->
  </div>

</div>
    

    <!--[if IE 8]>
    <script type="text/javascript" charset="utf-8">
      $(document.body).addClass("ie8")
    </script>
    <![endif]-->

    <!--[if IE 7]>
    <script type="text/javascript" charset="utf-8">
      $(document.body).addClass("ie7")
    </script>
    <![endif]-->

    <script type="text/javascript">
      _kmq.push(['trackClick', 'entice-signup-button', 'Entice banner clicked']);
      
    </script>
    
  </body>
</html>

